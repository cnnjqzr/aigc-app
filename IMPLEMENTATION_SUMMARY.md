# Nano Banana API é›†æˆå®æ–½æ€»ç»“

## âœ… å®æ–½å®Œæˆ

æ‰€æœ‰è®¡åˆ’ä¸­çš„åŠŸèƒ½å·²æˆåŠŸå®ç°ï¼Œnano-banana API å·²å®Œæ•´é›†æˆåˆ°é¡¹ç›®ä¸­ã€‚

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶ (7ä¸ª)

1. **lib/task-store.ts** (84è¡Œ)
   - ä»»åŠ¡çŠ¶æ€ç®¡ç†ç³»ç»Ÿ
   - æ”¯æŒ CRUD æ“ä½œ
   - è‡ªåŠ¨æ¸…ç†è¿‡æœŸä»»åŠ¡

2. **lib/image-upload.ts** (65è¡Œ)
   - å›¾ç‰‡ä¸Šä¼ å’ŒéªŒè¯
   - æ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼
   - è¿”å›å…¬ç½‘å¯è®¿é—®URL

3. **lib/download-image.ts** (71è¡Œ)
   - ä»è¿œç¨‹URLä¸‹è½½å›¾ç‰‡
   - è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡æ ¼å¼
   - æ‰¹é‡ä¸‹è½½æ”¯æŒ

4. **app/api/webhook/nano-banana/route.ts** (130è¡Œ)
   - Webhook å›è°ƒæ¥æ”¶ç«¯ç‚¹
   - è‡ªåŠ¨ä¸‹è½½ç”Ÿæˆçš„å›¾ç‰‡
   - æ›´æ–°ä»»åŠ¡çŠ¶æ€
   - æ”¯æŒ GET éªŒè¯

5. **app/api/task/[taskId]/route.ts** (44è¡Œ)
   - ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢API
   - è¿”å›å®Œæ•´çš„ç”Ÿæˆè®°å½•
   - æ”¯æŒå‰ç«¯è½®è¯¢

6. **NANO_BANANA_INTEGRATION.md** (è¯¦ç»†æ–‡æ¡£)
   - å®Œæ•´çš„é›†æˆè¯´æ˜
   - API ä½¿ç”¨ç¤ºä¾‹
   - æ•…éšœæ’æŸ¥æŒ‡å—

7. **NANO_BANANA_QUICKSTART.md** (å¿«é€ŸæŒ‡å—)
   - å¿«é€Ÿå¯åŠ¨æ­¥éª¤
   - å¸¸è§é—®é¢˜è§£ç­”
   - è°ƒè¯•æŠ€å·§

### ä¿®æ”¹æ–‡ä»¶ (3ä¸ª)

1. **lib/env.ts**
   - â• æ·»åŠ  `webhookBaseUrl` é…ç½®

2. **app/api/generate/image/route.ts** (å®Œå…¨é‡æ„)
   - âœ… æ¥å…¥çœŸå® nano-banana API
   - âœ… æ”¯æŒæ–‡ç”Ÿå›¾æ¨¡å¼
   - âœ… æ”¯æŒå›¾ç”Ÿå›¾æ¨¡å¼
   - âœ… é…ç½® webhook å›è°ƒ
   - âœ… åˆ›å»ºå’Œç®¡ç†ä»»åŠ¡
   - ğŸ”’ ä¿ç•™ Seedream æ¨¡å‹å…¼å®¹æ€§

3. **components/image-generator.tsx**
   - âœ… å®ç°ä»»åŠ¡è½®è¯¢é€»è¾‘
   - âœ… æ”¯æŒå¼‚æ­¥ç”Ÿæˆæµç¨‹
   - âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
   - ğŸ¨ ä¿æŒåŸæœ‰æ ·å¼ä¸å˜

## ğŸ”§ æŠ€æœ¯å®ç°

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ç»„ä»¶   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. å‘é€ç”Ÿæˆè¯·æ±‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Generate APIâ”‚ â”€â”€2. åˆ›å»ºä»»åŠ¡â”€â”€> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚ Task Store   â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. è°ƒç”¨ nano-banana
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nano Banana â”‚
â”‚     API     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 4. å¼‚æ­¥å¤„ç†
       â”‚ 5. Webhook å›è°ƒ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Webhook API â”‚ â”€â”€6. ä¸‹è½½å›¾ç‰‡â”€â”€> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚  ä¸‹è½½å¹¶ä¿å­˜   â”‚
       â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 7. æ›´æ–°ä»»åŠ¡çŠ¶æ€
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Task Query  â”‚ <â”€â”€8. è½®è¯¢çŠ¶æ€â”€â”€  â”‚   å‰ç«¯ç»„ä»¶    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 9. è¿”å›ç»“æœ
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å±•ç¤ºå›¾ç‰‡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒåŠŸèƒ½

#### 1. å¼‚æ­¥ä»»åŠ¡ç®¡ç†
- ä»»åŠ¡åˆ›å»ºå’ŒçŠ¶æ€è·Ÿè¸ª
- æ”¯æŒ pending â†’ processing â†’ completed/failed
- å†…å­˜å­˜å‚¨ï¼ˆå¯æ‰©å±•ä¸ºæ•°æ®åº“ï¼‰

#### 2. Webhook å›è°ƒ
- æ¥æ”¶ nano-banana å¼‚æ­¥å›è°ƒ
- è‡ªåŠ¨ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°
- æ›´æ–°ä»»åŠ¡çŠ¶æ€
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

#### 3. å‰ç«¯è½®è¯¢
- æ¯3ç§’è½®è¯¢ä»»åŠ¡çŠ¶æ€
- æœ€å¤šè½®è¯¢60æ¬¡ï¼ˆ3åˆ†é’Ÿï¼‰
- è‡ªåŠ¨åœæ­¢å’Œé”™è¯¯å¤„ç†
- æ— ç¼å±•ç¤ºç»“æœ

#### 4. å›¾ç‰‡å¤„ç†
- ä¸Šä¼ ï¼šéªŒè¯æ ¼å¼å’Œå¤§å°
- ä¸‹è½½ï¼šè‡ªåŠ¨è¯†åˆ«æ ¼å¼
- å­˜å‚¨ï¼šæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
- URLï¼šæ”¯æŒå…¬ç½‘è®¿é—®

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### æ–‡ç”Ÿå›¾ (Text-to-Image)
- âœ… æ”¯æŒå¤šç§å›¾ç‰‡å°ºå¯¸æ¯”ä¾‹
- âœ… è‡ªå®šä¹‰ç”Ÿæˆæ­¥æ•°
- âœ… å¼‚æ­¥ç”Ÿæˆæµç¨‹
- âœ… è‡ªåŠ¨ä¸‹è½½å’Œä¿å­˜

### å›¾ç”Ÿå›¾ (Image-to-Image)
- âœ… ä¸Šä¼ å‚è€ƒå›¾ç‰‡
- âœ… å›¾ç‰‡æ ¼å¼éªŒè¯
- âœ… å›¾ç‰‡å¤§å°é™åˆ¶
- âœ… å…¬ç½‘URLç”Ÿæˆ

### é”™è¯¯å¤„ç†
- âœ… API é…ç½®æ£€æŸ¥
- âœ… æ–‡ä»¶éªŒè¯
- âœ… ç½‘ç»œé”™è¯¯æ•è·
- âœ… è¶…æ—¶å¤„ç†
- âœ… è¯¦ç»†é”™è¯¯ä¿¡æ¯

### ç”¨æˆ·ä½“éªŒ
- ğŸ¨ ä¿æŒåŸæœ‰æ ·å¼ä¸å˜
- â³ æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
- ğŸ“ è¯¦ç»†çš„çŠ¶æ€æç¤º
- ğŸ”„ è‡ªåŠ¨åˆ·æ–°åˆ—è¡¨
- ğŸ“¥ ä¸€é”®ä¸‹è½½å›¾ç‰‡

## ğŸ“Š ä»£ç è´¨é‡

- âœ… TypeScript ç±»å‹å®Œæ•´
- âœ… æ—  Linter é”™è¯¯
- âœ… è¯¦ç»†çš„ä»£ç æ³¨é‡Š
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… æ§åˆ¶å°æ—¥å¿—è®°å½•

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### å¿…éœ€é…ç½®
```env
NANO_BANANA_API_URL=https://api.kie.ai/nano-banana
NANO_BANANA_API_KEY=your_api_key
WEBHOOK_BASE_URL=https://your-domain.com
```

### å¯é€‰é…ç½®
- Seedream APIï¼ˆå¦‚éœ€ä½¿ç”¨ï¼‰
- Veo 3 APIï¼ˆå¦‚éœ€ä½¿ç”¨ï¼‰
- Sora 2 APIï¼ˆå¦‚éœ€ä½¿ç”¨ï¼‰

## ğŸ§ª æµ‹è¯•å»ºè®®

### å•å…ƒæµ‹è¯•
- [ ] Task Store CRUD æ“ä½œ
- [ ] å›¾ç‰‡ä¸Šä¼ éªŒè¯
- [ ] å›¾ç‰‡ä¸‹è½½åŠŸèƒ½
- [ ] Webhook æ•°æ®è§£æ

### é›†æˆæµ‹è¯•
- [ ] æ–‡ç”Ÿå›¾å®Œæ•´æµç¨‹
- [ ] å›¾ç”Ÿå›¾å®Œæ•´æµç¨‹
- [ ] Webhook å›è°ƒå¤„ç†
- [ ] ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢

### E2E æµ‹è¯•
- [ ] ç”¨æˆ·å®Œæ•´æ“ä½œæµç¨‹
- [ ] é”™è¯¯åœºæ™¯å¤„ç†
- [ ] è¶…æ—¶åœºæ™¯å¤„ç†
- [ ] å¹¶å‘ç”Ÿæˆæµ‹è¯•

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
1. ä½¿ç”¨ ngrok æˆ– cloudflared æš´éœ²æœ¬åœ°ç«¯å£
2. é…ç½® WEBHOOK_BASE_URL
3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

### ç”Ÿäº§ç¯å¢ƒ
1. éƒ¨ç½²åˆ° Vercel/Netlify ç­‰å¹³å°
2. é…ç½®ç¯å¢ƒå˜é‡
3. ä½¿ç”¨äº‘å­˜å‚¨ï¼ˆæ¨èï¼‰
4. é›†æˆæ•°æ®åº“ï¼ˆæ¨èï¼‰
5. æ·»åŠ ç›‘æ§å’Œæ—¥å¿—

## ğŸ” å®‰å…¨è€ƒè™‘

- âœ… API å¯†é’¥ä»…åœ¨æœåŠ¡ç«¯ä½¿ç”¨
- âœ… æ–‡ä»¶å¤§å°å’Œæ ¼å¼éªŒè¯
- âœ… é”™è¯¯ä¿¡æ¯ä¸æš´éœ²æ•æ„Ÿæ•°æ®
- âš ï¸ Webhook ç­¾åéªŒè¯ï¼ˆå¾…å®ç°ï¼‰
- âš ï¸ ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ˆå¾…å®ç°ï¼‰
- âš ï¸ è¯·æ±‚é™æµï¼ˆå¾…å®ç°ï¼‰

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å½“å‰å®ç°
- å†…å­˜å­˜å‚¨ä»»åŠ¡çŠ¶æ€
- æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨å›¾ç‰‡
- å‰ç«¯è½®è¯¢æŸ¥è¯¢çŠ¶æ€

### ä¼˜åŒ–æ–¹å‘
1. **æ•°æ®åº“** - Prisma + PostgreSQL
2. **ç¼“å­˜** - Redis ç¼“å­˜ä»»åŠ¡çŠ¶æ€
3. **é˜Ÿåˆ—** - Bull/BullMQ ä»»åŠ¡é˜Ÿåˆ—
4. **å®æ—¶** - WebSocket æ¨é€ï¼ˆæ›¿ä»£è½®è¯¢ï¼‰
5. **å­˜å‚¨** - AWS S3/Cloudflare R2
6. **CDN** - å›¾ç‰‡åŠ é€Ÿè®¿é—®

## ğŸ“ åç»­æ”¹è¿›å»ºè®®

### çŸ­æœŸ (1-2å‘¨)
- [ ] æ·»åŠ  Webhook ç­¾åéªŒè¯
- [ ] å®ç°ä»»åŠ¡æ¸…ç†å®šæ—¶ä»»åŠ¡
- [ ] æ·»åŠ æ›´å¤šæ—¥å¿—å’Œç›‘æ§
- [ ] å®Œå–„é”™è¯¯æç¤ºä¿¡æ¯

### ä¸­æœŸ (1-2æœˆ)
- [ ] é›†æˆæ•°æ®åº“å­˜å‚¨
- [ ] å®ç°ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] æ·»åŠ æ‰¹é‡ç”ŸæˆåŠŸèƒ½
- [ ] å®ç°å›¾ç‰‡ç¼–è¾‘å†å²

### é•¿æœŸ (3-6æœˆ)
- [ ] WebSocket å®æ—¶æ¨é€
- [ ] äº‘å­˜å‚¨é›†æˆ
- [ ] ç”¨æˆ·é…é¢ç®¡ç†
- [ ] é«˜çº§ç¼–è¾‘åŠŸèƒ½

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **NANO_BANANA_INTEGRATION.md** - è¯¦ç»†é›†æˆæ–‡æ¡£
2. **NANO_BANANA_QUICKSTART.md** - å¿«é€Ÿå¯åŠ¨æŒ‡å—
3. **API_INTEGRATION.md** - é€šç”¨APIé›†æˆè¯´æ˜
4. **README.md** - é¡¹ç›®æ€»ä½“è¯´æ˜

## âœ¨ æ€»ç»“

æœ¬æ¬¡é›†æˆæˆåŠŸå®ç°äº†ï¼š

- âœ… å®Œæ•´çš„ nano-banana API é›†æˆ
- âœ… å¼‚æ­¥ webhook å›è°ƒæœºåˆ¶
- âœ… å‰ç«¯è½®è¯¢å’ŒçŠ¶æ€ç®¡ç†
- âœ… å›¾ç‰‡ä¸Šä¼ ä¸‹è½½å¤„ç†
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… ä¿æŒå‰ç«¯æ ·å¼ä¸å˜
- âœ… è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜

ç³»ç»Ÿå·²ç»å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œåªéœ€é…ç½®æ­£ç¡®çš„ç¯å¢ƒå˜é‡å³å¯å¼€å§‹æµ‹è¯•ã€‚

---

**å®æ–½æ—¥æœŸ**: 2025-10-23  
**å®æ–½çŠ¶æ€**: âœ… å®Œæˆ  
**ä»£ç è´¨é‡**: âœ… é€šè¿‡  
**æ–‡æ¡£å®Œæ•´æ€§**: âœ… å®Œæ•´

